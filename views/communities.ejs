<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <link rel="stylesheet" href="./css/navbar.css" />
    <link rel="stylesheet" href="./css/communities.css" />
  </head>
  <body>
    <%- include('partials/navbar', { pagePath: 'communities' }) %>

    <div id="com-btn-container"></div>

    <div id="posts-container">
      <!-- JavaScript will populate this container with posts from JavaScript object -->
    </div>

    <script>
      const communities = [
        { name: "trending", icon: "trending_up" },
        { name: "new", icon: "schedule" },
        { name: "explore", icon: "public" },
        { name: "general", icon: "groups" },
        { name: "ml-ai", icon: "robot" },
        { name: "it-tech", icon: "developer_board" },
        { name: "web-dev", icon: "web" },
        { name: "cybersecurity", icon: "admin_panel_settings" },
        { name: "game-dev", icon: "sports_esports" },
        { name: "ios-dev", icon: "ios" },
        { name: "android-dev", icon: "android" },
        { name: "data-science", icon: "monitoring" },
        { name: "web3", icon: "currency_bitcoin" },
        { name: "cloud", icon: "cloud" },
        { name: "devops", icon: "settings" },
        { name: "AI-ethics", icon: "volunteer_activism" },
        { name: "UX-design", icon: "design_services" },
        { name: "software-testing", icon: "check_circle" },
        { name: "agile-development", icon: "scatter_plot" },
        // add more communities as needed
      ];
      function createButtons() {
        const container = document.getElementById("com-btn-container");

        communities.forEach((community) => {
          const button = document.createElement("button");
          button.className = "com-btn";
          button.setAttribute("data-community", community.name);

          const span = document.createElement("span");
          span.className = "material-symbols-outlined";
          span.textContent = community.icon;

          button.appendChild(span);
          button.appendChild(
            document.createTextNode(
              ` ${community.name.replace(/-/g, " ").toUpperCase()}`
            )
          );

          container.appendChild(button);
        });
      }

      // Call the function to create buttons on page load
      createButtons();
      // Define post data as a JavaScript object
      const postData = [
        {
          title: "[Project] Open Source Chatbot",
          author: "user123",
          date: "2023-11-25",
          description:
            "Check out my new open-source project on GitHub - a chatbot built with Python and machine learning. Contributions are welcome!",
          thumbnail_image_url: "/thumbnail_image_url.jpg",
          community: "ml-ai",
          upvotes: 120,
          downvotes: 4,
          favorites: 38,
        },
        {
          title: "[Project] AI-Powered Recommendation System",
          author: "techWizard",
          date: "2023-11-26",
          description:
            "Excited to share my latest project on GitHub - an AI-powered recommendation system for movies and TV shows. Join the collaboration!",
          thumbnail_image_url: "/thumbnail_image_url.jpg",
          community: "ml-ai",
          upvotes: 120,
          downvotes: 4,
          favorites: 123,
        },
        {
          title: "[Project] Online Quiz Platform",
          author: "quizMaster",
          date: "2023-11-27",
          description:
            "Just launched my online quiz platform! It's built with React and Node.js. Try it out and let me know your thoughts!",
          thumbnail_image_url: "/thumbnail_image_url.jpg",
          community: "web-dev",
          upvotes: 120,
          downvotes: 4,
          favorites: 22,
        },
        {
          title: "[Post] Mobile App Update",
          author: "appDevPro",
          date: "2023-11-28",
          description:
            "We've just released a major update to our mobile app! New features, improved performance, and bug fixes. Check it out now!",
          thumbnail_image_url: "/thumbnail_image_url.jpg",
          community: "ios-dev",
          upvotes: 120,
          downvotes: 4,
          favorites: 91,
        },
        {
          title: "[Project] Machine Learning Chat Application",
          author: "AIEnthusiast",
          date: "2023-12-01",
          description:
            "I've built a machine learning-powered chat application that can understand natural language. Join the conversation and experience the future of chatbots!",
          thumbnail_image_url: "/thumbnail_image_url.jpg",
          community: "ml-ai",
          upvotes: 85,
          downvotes: 3,
          favorites: 42,
        },
        {
          title: "[Tutorial] Building a RESTful API with Express",
          author: "webDev101",
          date: "2023-12-02",
          description:
            "Learn how to build a RESTful API using Express.js. This step-by-step tutorial covers routing, middleware, and database integration. Get started now!",
          thumbnail_image_url: "/thumbnail_image_url.jpg",
          community: "web-dev",
          upvotes: 92,
          downvotes: 2,
          favorites: 18,
        },
        {
          title: "[Discussion] Future of Artificial Intelligence",
          author: "AIInsights",
          date: "2023-12-03",
          description:
            "Let's discuss the future of AI and its impact on society. What ethical considerations should we keep in mind? Share your thoughts and ideas!",
          thumbnail_image_url: "/thumbnail_image_url.jpg",
          community: "ml-ai",
          upvotes: 68,
          downvotes: 7,
          favorites: 31,
        },
        {
          title: "[Project] E-commerce Website Redesign",
          author: "webDesignPro",
          date: "2023-12-04",
          description:
            "I've redesigned an e-commerce website with a modern and user-friendly interface. Check out the new look and provide feedback!",
          thumbnail_image_url: "/thumbnail_image_url.jpg",
          community: "web-dev",
          upvotes: 57,
          downvotes: 1,
          favorites: 24,
        },
      ];

      const postsContainer = document.getElementById("posts-container");

      postData.forEach((post) => {
        const postElement = document.createElement("div");
        postElement.classList.add("post");

        // Adding the header extraction from the title
        const headerMatch = post.title.match(/^\[(.+?)\]/);
        const header = headerMatch ? headerMatch[1] : "";
        const titleWithoutHeader = headerMatch
          ? post.title.replace(headerMatch[0], "").trim()
          : post.title;

        // Create the post content HTML here using the data from the JavaScript object, with header added
        const postContentHTML = `
        <div class="thumbnail">
          <img
            src="${post.thumbnail_image_url}"
            alt="Thumbnail Image"
            class="thumbnail-image"
          />
        </div>
        <div class="post-content">
          <div class="title"><span class="header">${header}</span> ${titleWithoutHeader}</div>
          <div class="user-info">
            <strong>${post.author}</strong> ${post.date}
            <span class="material-symbols-outlined"> thumb_up </span>
            <span>${post.upvotes}</span>
            <span class="material-symbols-outlined"> thumb_down </span>
            <span>${post.downvotes}</span>
            <span class="material-symbols-outlined"> comment </span>
            <span>${post.favorites}</span>
            <span class="community-name">${post.community}</span>
          </div>
          <div class="description">${post.description}</div>
        </div>
      `;

        postElement.innerHTML = postContentHTML;
        postsContainer.appendChild(postElement);
      });
    </script>
  </body>
</html>
